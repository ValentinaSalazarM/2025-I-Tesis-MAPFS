MAPFS time=2025-04-20 15:37:59,693 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8010.'
MAPFS time=2025-04-20 15:37:59,720 level=INFO msg='Conectado al CA en mapfs-cloud:5001'
MAPFS time=2025-04-20 15:37:59,720 level=INFO msg='[REG] Enviada solicitud de registro al CA.'
MAPFS time=2025-04-20 15:37:59,730 level=INFO msg='[REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 21177946515075061687550791694630544457495970075002376965874600479642368933534, 'y': 92236785872001380457189012603395899274187319854444042842081342129414266413390}, 'P_IoT_key': {'x': 11793167108374714450081443668939525841347829016346511493581507395368730469025, 'y': 22411024432054074270843369479455891801200931331140479066062892424924858034562}, 'operation': b'\xad\xe8"\xb2\xd7\xab'}.'
MAPFS time=2025-04-20 15:37:59,735 level=INFO msg='[REG] Enviada información de registro al CA: {'operation': 'register_gateway', 'Gateway_Identity': 3445939985476440605, 'X_w_pub_key': {'x': 45430545540069393172942792458423082409066439757237537565595191725645429671265, 'y': 114909364873093874814031642025679172288290918422996675110069379569963988914624}}.'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='[REG] Respuesta recibida del CA.'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='[REG] Parámetros recibidos del CA.'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='[REG] Registro completado exitosamente con los siguientes parámetros.'
MAPFS time=2025-04-20 15:37:59,741 level=INFO msg='Socket con el CA cerrado correctamente.'
MAPFS time=2025-04-20 15:37:59,741 level=INFO msg='[REG] Conexión con el CA cerrada.'
MAPFS time=2025-04-20 15:37:59,742 level=INFO msg='Socket Gateway escuchando en 0.0.0.0:5000'
MAPFS time=2025-04-20 15:37:59,743 level=INFO msg='[REVOC] Esperando respuestas de revocación en el puerto 6000.'
MAPFS time=2025-04-20 15:37:59,743 level=INFO msg='Monitoreando actividad sospechosa de los dispositivos'
MAPFS time=2025-04-20 15:38:05,262 level=INFO msg='Conexión aceptada de ('172.18.0.10', 56068)'
MAPFS time=2025-04-20 15:38:05,263 level=INFO msg='Mensaje recibido: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}}'
MAPFS time=2025-04-20 15:38:05,263 level=INFO msg='[AUTH] Mensaje recibido del IoT Device: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}}'
MAPFS time=2025-04-20 15:38:05,268 level=INFO msg='[AUTH] Enviado token de autenticación al dispositivo IoT: {'operation': 'mutual_authentication', 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'ID_w': 3445939985476440605, 'X_w_pub_key': {'x': 45430545540069393172942792458423082409066439757237537565595191725645429671265, 'y': 114909364873093874814031642025679172288290918422996675110069379569963988914624}, 'Y_w_pub_key': {'x': 3029868824243643875722711890918973288729147127789719230203469428232660372707, 'y': 56749431097275587367271285635028116033939373862123034215890038219149915741680}, 'sigma_z': 72774760574563567446875734670326309675898750600424418682064873645167069883827}'
MAPFS time=2025-04-20 15:38:05,290 level=INFO msg='[AUTH] Puntos, compromisos y respuestas ZKP del dispositivo recibidos.'
MAPFS time=2025-04-20 15:38:05,290 level=INFO msg='[AUTH] Verificando la firma del IoT.'
MAPFS time=2025-04-20 15:38:05,300 level=INFO msg='[AUTH] Llave pública del CA y I_1 verificados.'
MAPFS time=2025-04-20 15:38:05,304 level=INFO msg='[AUTH] La llave de sesión en el gateway es: 1832926791702887'
MAPFS time=2025-04-20 15:38:05,304 level=INFO msg='[AUTH] unique_identifier: 26169546977177398376828787035898709680643326608258830504779412651760994964658'
MAPFS time=2025-04-20 15:38:05,305 level=INFO msg='[AUTH] Autenticación mutua culminada.'
MAPFS time=2025-04-20 15:38:05,305 level=INFO msg='[AUTH] Conexión con el CA cerrada.'
MAPFS time=2025-04-20 15:38:05,305 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:38:05,322 level=INFO msg='Conexión aceptada de ('172.18.0.10', 56070)'
MAPFS time=2025-04-20 15:38:05,322 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'w38PGAfisgbkgE/dyUW9FQ==', 'encrypted_metrics': '7l9SfPAvNE9Ns2iSca2071R7mk6N+VPiL/dOl5NNf2c35fl+2AIFvB7k3CqeEBPu'}'
MAPFS time=2025-04-20 15:38:05,333 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 23.04, 'humidity': 62.94}'
MAPFS time=2025-04-20 15:38:05,334 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-04-20 15:38:05,334 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:39:05,417 level=INFO msg='Conexión aceptada de ('172.18.0.10', 43368)'
MAPFS time=2025-04-20 15:39:05,418 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'iqsAfNqrMoNCBY93fRvWsQ==', 'encrypted_metrics': 'z2EzjNbgwnqf2qzsuw2zfaw6nclE3aFx0+oJf2QXkWxs+fiALD0kHlM7RdX0MAd1'}'
MAPFS time=2025-04-20 15:39:05,418 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.98, 'humidity': 57.77}'
MAPFS time=2025-04-20 15:39:05,419 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-04-20 15:39:05,419 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:40:05,476 level=INFO msg='Conexión aceptada de ('172.18.0.10', 47206)'
MAPFS time=2025-04-20 15:40:05,476 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': '/j02tsbGIuOKCYDgsk/+Wg==', 'encrypted_metrics': 'evsq2sr0RfJgkLPtDlM6PUhuI+w2XCwCF2v8anPXYNstM88J0EiLyYs8t2iV2r7v'}'
MAPFS time=2025-04-20 15:40:05,477 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.22, 'humidity': 52.56}'
MAPFS time=2025-04-20 15:40:05,477 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-04-20 15:40:05,478 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:40:14,432 level=INFO msg='Conexión aceptada de ('172.18.0.4', 58584)'
MAPFS time=2025-04-20 15:40:14,433 level=INFO msg='Mensaje recibido: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}}'
MAPFS time=2025-04-20 15:40:14,433 level=INFO msg='[AUTH] Mensaje recibido del IoT Device: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}}'
MAPFS time=2025-04-20 15:40:14,434 level=INFO msg='[AUTH] Enviado token de autenticación al dispositivo IoT: {'operation': 'mutual_authentication', 'W': {'x': 59296889694094656930228174536097432771536501239039539096046096477422765584446, 'y': 16001268324212414898023100363087548496505090789112536773845742367642886463799}, 'ID_w': 3445939985476440605, 'X_w_pub_key': {'x': 45430545540069393172942792458423082409066439757237537565595191725645429671265, 'y': 114909364873093874814031642025679172288290918422996675110069379569963988914624}, 'Y_w_pub_key': {'x': 3029868824243643875722711890918973288729147127789719230203469428232660372707, 'y': 56749431097275587367271285635028116033939373862123034215890038219149915741680}, 'sigma_z': 28177460582169713995516723726136596517947593827226398609389924930464370904158}'
MAPFS time=2025-04-20 15:40:14,935 level=INFO msg='[AUTH] Puntos, compromisos y respuestas ZKP del dispositivo recibidos.'
MAPFS time=2025-04-20 15:40:14,936 level=INFO msg='[AUTH] Verificando la firma del IoT.'
MAPFS time=2025-04-20 15:40:14,941 level=ERROR msg='[AUTH] Error durante la autenticación mutua: Error autenticando el dispositivo IoT.'
MAPFS time=2025-04-20 15:40:14,941 level=INFO msg='[AUTH] Conexión con el CA cerrada.'
MAPFS time=2025-04-20 15:40:14,942 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:41:00,198 level=INFO msg='Conexión aceptada de ('172.18.0.4', 57884)'
MAPFS time=2025-04-20 15:41:00,198 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'ID_obfuscated': None, 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'qYnD1mJvTdUgU3TQUoRpnQ==', 'encrypted_metrics': 'fzmoUfsPav5dpfs7rLWvBv9P0pBauWkJb4Aju/+WuIiST3IJn4DsTPU7Mo1f1Pls'}'
MAPFS time=2025-04-20 15:41:00,199 level=ERROR msg='[METRICS] Error en el mensaje recibido: Padding is incorrect.'
MAPFS time=2025-04-20 15:41:00,199 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:41:05,522 level=INFO msg='Conexión aceptada de ('172.18.0.10', 51144)'
MAPFS time=2025-04-20 15:41:05,523 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'bV5PFo81C2kqk3Lt2bfYnA==', 'encrypted_metrics': 'WEOiUwQypwj2C1adYX2A/k1SyUfXGkIJv4ICS/YLd1NlyROBr4Khq5A6rzHiXtFi'}'
MAPFS time=2025-04-20 15:41:05,523 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 26.03, 'humidity': 55.65}'
MAPFS time=2025-04-20 15:41:05,523 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-04-20 15:41:05,524 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:41:38,592 level=INFO msg='[REVOC] Mensaje recibido: {'operation': 'identify_and_revoke', 'ID_a': 12690263487218622427, 'X_a_pub_key': {'x': 4012385738547435301142039489199932682211343568487251552973528691858139015094, 'y': 84726835359740451950929447891920657063279224681046027640857329293432813694342}, 'Y_a_pub_key': {'x': 83704805075390084828880892119956347538020387902824187657320850778920410051239, 'y': 112287209389999757352027095666199169469281051028413447113166459860137049025351}, 'h_a': 27550289557081766113616009622046570385274335276087354250852223971515873831813, 'P_1': {'x': 95511148566065364250942207858655193192425991347096017143134118521577008182548, 'y': 99738441963798228302116853883118045234903444266142981682664839257102420392606}, 'P_3': {'x': 2379776427754342215847616503272387354119552286279675908882668469333857606805, 'y': 53452390842102568830880033844100139093331372161346302970565721582733187540859}}'
MAPFS time=2025-04-20 15:41:38,595 level=INFO msg='[REVOC] revocation_id = 73721401861891050294922551610899984843461739536428315371037982279597835132618'
MAPFS time=2025-04-20 15:41:38,596 level=INFO msg='unique_identifier = 26169546977177398376828787035898709680643326608258830504779412651760994964658'
MAPFS time=2025-04-20 15:41:38,596 level=INFO msg='[REVOC] Dispositivo revocado y bloqueado.'
MAPFS time=2025-04-20 15:42:05,557 level=INFO msg='Conexión aceptada de ('172.18.0.10', 32986)'
MAPFS time=2025-04-20 15:42:05,557 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'rEmhnxuTrMDzc7CGiT65NQ==', 'encrypted_metrics': 'CpRKJjUb+X7c0jgamPUCx6dTGvQHEabHGocsrC9eBvRo0tFnjVsjxaEKhEKWo9yt'}'
MAPFS time=2025-04-20 15:42:05,557 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 26169546977177398376828787035898709680643326608258830504779412651760994964658 no autenticado.'
MAPFS time=2025-04-20 15:42:05,558 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:43:05,614 level=INFO msg='Conexión aceptada de ('172.18.0.10', 38444)'
MAPFS time=2025-04-20 15:43:05,615 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'z/E+YnRHu6DGl69LENeqSQ==', 'encrypted_metrics': 'yQMDv+rxUlKCxdO0jdB0rRuwUw5rOhWZ09b2yvHI7KEgpHn1puvcbNba6JHpSLE2'}'
MAPFS time=2025-04-20 15:43:05,616 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 26169546977177398376828787035898709680643326608258830504779412651760994964658 no autenticado.'
MAPFS time=2025-04-20 15:43:05,616 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:44:05,672 level=INFO msg='Conexión aceptada de ('172.18.0.10', 34042)'
MAPFS time=2025-04-20 15:44:05,673 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'xvL58+UcS9E3InxmjnmOzg==', 'encrypted_metrics': 'z/sd+F6h7uC6y/375RCcgYj0Y8/RZLFkna7OOYsopu0vajmBweKJilBPt8jMbbLR'}'
MAPFS time=2025-04-20 15:44:05,673 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 26169546977177398376828787035898709680643326608258830504779412651760994964658 no autenticado.'
MAPFS time=2025-04-20 15:44:05,673 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:45:05,732 level=INFO msg='Conexión aceptada de ('172.18.0.10', 42800)'
MAPFS time=2025-04-20 15:45:05,732 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'g0Ab5fFiAoO8wltRwPH3tA==', 'encrypted_metrics': 'MmescxQikHvkHYqqLsEeSfmjAHIslAIhHPK+586w/bTLISULdBA+zo0VCd6MRPQ9'}'
MAPFS time=2025-04-20 15:45:05,733 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 26169546977177398376828787035898709680643326608258830504779412651760994964658 no autenticado.'
MAPFS time=2025-04-20 15:45:05,734 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:46:05,787 level=INFO msg='Conexión aceptada de ('172.18.0.10', 44118)'
MAPFS time=2025-04-20 15:46:05,787 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 20404082767355105443692771561123839541855884820554563060945580198520504055707, 'y': 28702998011945567854258662149020243923537589254371259038042824862898097354510}, 'W': {'x': 94605702200446299135467957888679407602816973759398559165355491569800041023104, 'y': 70469839561251432690332927567355959634580542606650144024138647316900426596297}, 'iv': 'N4Ce7NXGDkMwyzFahlVo+A==', 'encrypted_metrics': 'ZS7ZB6IZPEJ502gLwjPbNJ+X3XCdzvcE/gKoC5O/W2VEuSkYqjTfiKQrP9k21x6m'}'
MAPFS time=2025-04-20 15:46:05,788 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 26169546977177398376828787035898709680643326608258830504779412651760994964658 no autenticado.'
MAPFS time=2025-04-20 15:46:05,788 level=INFO msg='Conexión con el cliente cerrada.'
