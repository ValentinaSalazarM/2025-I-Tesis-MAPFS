MAPFS time=2025-02-25 12:22:03,763 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8010.'
MAPFS time=2025-02-25 12:22:03,771 level=INFO msg='Conectado al CA en mapfs-cloud:5001'
MAPFS time=2025-02-25 12:22:03,771 level=INFO msg='[REG] Enviada solicitud de registro al CA.'
MAPFS time=2025-02-25 12:22:03,772 level=INFO msg='[REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 28016041725865967312176845563250474133521285695203706788428665086577198517474, 'y': 23976161944816471538076338850234997785604458081584766042393683318273522769049}, 'P_IoT_key': {'x': 99284342244383914923509531893348465789114011022055980731481010453518241587650, 'y': 42051977687689523936907964182636531521746747060850523130700341182277898620174}, 'operation': b'\xad\xe8"\xb2\xd7\xab'}.'
MAPFS time=2025-02-25 12:22:03,774 level=INFO msg='[REG] Enviada información de registro al CA: {'operation': 'register_gateway', 'Gateway_Identity': 2083438182807212842, 'X_w_pub_key': {'x': 8845098255066629046805580635796768317488784232137532982721101963881043043294, 'y': 94240904857906626408252076997232178786230076288863012618513254438399197765785}}.'
MAPFS time=2025-02-25 12:22:03,775 level=INFO msg='[REG] Respuesta recibida del CA.'
MAPFS time=2025-02-25 12:22:03,775 level=INFO msg='[REG] Parámetros recibidos del CA.'
MAPFS time=2025-02-25 12:22:03,775 level=INFO msg='[REG] Registro completado exitosamente con los siguientes parámetros.'
MAPFS time=2025-02-25 12:22:03,776 level=INFO msg='Socket con el CA cerrado correctamente.'
MAPFS time=2025-02-25 12:22:03,776 level=INFO msg='[REG] Conexión con el CA cerrada.'
MAPFS time=2025-02-25 12:22:03,778 level=INFO msg='Monitoreando actividad sospechosa de los dispositivos'
MAPFS time=2025-02-25 12:22:03,778 level=INFO msg='[REVOC] Esperando respuestas de revocación en el puerto 6000.'
MAPFS time=2025-02-25 12:22:03,778 level=INFO msg='Socket Gateway escuchando en 0.0.0.0:5000'
MAPFS time=2025-02-25 12:22:09,135 level=INFO msg='Conexión aceptada de ('172.18.0.4', 53664)'
MAPFS time=2025-02-25 12:22:09,135 level=INFO msg='Mensaje recibido: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 7088292301260485905132150975897631266646409844694035650224572633679913437137, 'y': 27754611834914833646102043688822606403212815133589033493615638577664600593878}}'
MAPFS time=2025-02-25 12:22:09,136 level=INFO msg='[AUTH] Mensaje recibido del IoT Device: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 7088292301260485905132150975897631266646409844694035650224572633679913437137, 'y': 27754611834914833646102043688822606403212815133589033493615638577664600593878}}'
MAPFS time=2025-02-25 12:22:09,137 level=INFO msg='[AUTH] Enviado token de autenticación al dispositivo IoT: {'operation': 'mutual_authentication', 'W': {'x': 59143546506228853880604321118828718654558472699065529354843495265217810333406, 'y': 30134931330425824043034960079489454162757613770825670005225046587474121844800}, 'ID_w': 2083438182807212842, 'X_w_pub_key': {'x': 8845098255066629046805580635796768317488784232137532982721101963881043043294, 'y': 94240904857906626408252076997232178786230076288863012618513254438399197765785}, 'Y_w_pub_key': {'x': 56118693797020856893768380716509186115996223938114662277721145086519687935794, 'y': 56966466960099333455014484865189481546964127926378923406387956812242962798301}, 'sigma_z': 476169148468926618946540975951439941268202148142242846765596983551714800294}'
MAPFS time=2025-02-25 12:22:09,148 level=INFO msg='[AUTH] Puntos, compromisos y respuestas ZKP del dispositivo recibidos.'
MAPFS time=2025-02-25 12:22:09,149 level=INFO msg='[AUTH] Verificando la firma del IoT.'
MAPFS time=2025-02-25 12:22:09,157 level=INFO msg='[AUTH] Llave pública del CA y I_1 verificados.'
MAPFS time=2025-02-25 12:22:09,160 level=INFO msg='[AUTH] La llave de sesión en el gateway es: 1072341920219910'
MAPFS time=2025-02-25 12:22:09,160 level=INFO msg='[AUTH] unique_identifier: 33944826850886236508609899937708393182687792455591959900631509449060723272191'
MAPFS time=2025-02-25 12:22:09,161 level=INFO msg='[AUTH] Autenticación mutua culminada.'
MAPFS time=2025-02-25 12:22:09,161 level=INFO msg='[AUTH] Conexión con el CA cerrada.'
MAPFS time=2025-02-25 12:22:09,161 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:22:09,162 level=INFO msg='Conexión aceptada de ('172.18.0.4', 53668)'
MAPFS time=2025-02-25 12:22:09,162 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 7088292301260485905132150975897631266646409844694035650224572633679913437137, 'y': 27754611834914833646102043688822606403212815133589033493615638577664600593878}, 'W': {'x': 59143546506228853880604321118828718654558472699065529354843495265217810333406, 'y': 30134931330425824043034960079489454162757613770825670005225046587474121844800}, 'iv': 'aCrMCrmMyIL0pxaIMOLQnA==', 'encrypted_metrics': 'oYBbDXHvxcuxnttf7qNlTvaET/Jai1rEO1nVhtdpE5cKTiI682IiA7z5XvtnFO/v'}'
MAPFS time=2025-02-25 12:22:09,163 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 29.34, 'humidity': 59.2}'
MAPFS time=2025-02-25 12:22:09,163 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:22:09,163 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:23:09,169 level=INFO msg='Conexión aceptada de ('172.18.0.4', 41344)'
MAPFS time=2025-02-25 12:23:09,170 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 7088292301260485905132150975897631266646409844694035650224572633679913437137, 'y': 27754611834914833646102043688822606403212815133589033493615638577664600593878}, 'W': {'x': 59143546506228853880604321118828718654558472699065529354843495265217810333406, 'y': 30134931330425824043034960079489454162757613770825670005225046587474121844800}, 'iv': '5qbI4OcEnA6dRN8oaR9FiQ==', 'encrypted_metrics': '6w3nbRUjMEX9wIZkYiZ9qmECpxvGy7o+XaVuHo6SORL2H7imYrKrQxIYrN0AoCQo'}'
MAPFS time=2025-02-25 12:23:09,170 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 26.05, 'humidity': 67.77}'
MAPFS time=2025-02-25 12:23:09,171 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:23:09,171 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:29:06,065 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8010.'
MAPFS time=2025-02-25 12:29:06,070 level=INFO msg='Conectado al CA en mapfs-cloud:5001'
MAPFS time=2025-02-25 12:29:06,071 level=INFO msg='[REG] Enviada solicitud de registro al CA.'
MAPFS time=2025-02-25 12:29:06,071 level=INFO msg='[REG] Recibidos parámetros públicos del CA: {'Pub_gc_key': {'x': 109521340432748956472139209563755641365087732359122554770476989078545074680657, 'y': 40595242514657673356073306240412431921351244935903944047919711663186952454746}, 'P_IoT_key': {'x': 43786896285046937119315437815159914505876922828525438313500292958631776988061, 'y': 63177569733180013220464876405260641918941762784898896634552622478675170881177}, 'operation': b'\xad\xe8"\xb2\xd7\xab'}.'
MAPFS time=2025-02-25 12:29:06,073 level=INFO msg='[REG] Enviada información de registro al CA: {'operation': 'register_gateway', 'Gateway_Identity': 12265738250215494897, 'X_w_pub_key': {'x': 37001352849199150237342310370515020284594588191989815513079452807482237384180, 'y': 29959703618878373930477313050103011539318410592764756573361649049088358205007}}.'
MAPFS time=2025-02-25 12:29:06,074 level=INFO msg='[REG] Respuesta recibida del CA.'
MAPFS time=2025-02-25 12:29:06,074 level=INFO msg='[REG] Parámetros recibidos del CA.'
MAPFS time=2025-02-25 12:29:06,074 level=INFO msg='[REG] Registro completado exitosamente con los siguientes parámetros.'
MAPFS time=2025-02-25 12:29:06,075 level=INFO msg='Socket con el CA cerrado correctamente.'
MAPFS time=2025-02-25 12:29:06,075 level=INFO msg='[REG] Conexión con el CA cerrada.'
MAPFS time=2025-02-25 12:29:06,076 level=INFO msg='Socket Gateway escuchando en 0.0.0.0:5000'
MAPFS time=2025-02-25 12:29:06,076 level=INFO msg='Monitoreando actividad sospechosa de los dispositivos'
MAPFS time=2025-02-25 12:29:06,076 level=INFO msg='[REVOC] Esperando respuestas de revocación en el puerto 6000.'
MAPFS time=2025-02-25 12:29:11,647 level=INFO msg='Conexión aceptada de ('172.18.0.11', 52808)'
MAPFS time=2025-02-25 12:29:11,648 level=INFO msg='Mensaje recibido: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}}'
MAPFS time=2025-02-25 12:29:11,648 level=INFO msg='[AUTH] Mensaje recibido del IoT Device: {'operation': 'mutual_authentication', 'step': 'hello', 'one_time_public_key': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}}'
MAPFS time=2025-02-25 12:29:11,649 level=INFO msg='[AUTH] Enviado token de autenticación al dispositivo IoT: {'operation': 'mutual_authentication', 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'ID_w': 12265738250215494897, 'X_w_pub_key': {'x': 37001352849199150237342310370515020284594588191989815513079452807482237384180, 'y': 29959703618878373930477313050103011539318410592764756573361649049088358205007}, 'Y_w_pub_key': {'x': 106202547820244527209793730748026566738291299426667560935412560542464941157117, 'y': 27066070564997182651906951551276470236043234652966546794206592818827545148795}, 'sigma_z': 53826722757539277775377907121069927777884106311935696110173055472833937364502}'
MAPFS time=2025-02-25 12:29:11,660 level=INFO msg='[AUTH] Puntos, compromisos y respuestas ZKP del dispositivo recibidos.'
MAPFS time=2025-02-25 12:29:11,660 level=INFO msg='[AUTH] Verificando la firma del IoT.'
MAPFS time=2025-02-25 12:29:11,669 level=INFO msg='[AUTH] Llave pública del CA y I_1 verificados.'
MAPFS time=2025-02-25 12:29:11,673 level=INFO msg='[AUTH] La llave de sesión en el gateway es: 1446228819469386'
MAPFS time=2025-02-25 12:29:11,673 level=INFO msg='[AUTH] unique_identifier: 96991248252922197919740685908646567083801574626180075667347743251664730525151'
MAPFS time=2025-02-25 12:29:11,673 level=INFO msg='[AUTH] Autenticación mutua culminada.'
MAPFS time=2025-02-25 12:29:11,674 level=INFO msg='[AUTH] Conexión con el CA cerrada.'
MAPFS time=2025-02-25 12:29:11,674 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:29:11,674 level=INFO msg='Conexión aceptada de ('172.18.0.11', 52820)'
MAPFS time=2025-02-25 12:29:11,675 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'pe9d4FfrrD9HUvRFZniv6A==', 'encrypted_metrics': 'ellAa/FkFrFb/4+LfqO8xrpLRecXF2ip57dNK21/f0w/Z6DWp8mBnVOko/1ntcb1'}'
MAPFS time=2025-02-25 12:29:11,675 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.9, 'humidity': 60.47}'
MAPFS time=2025-02-25 12:29:11,675 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:29:11,676 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:30:11,736 level=INFO msg='Conexión aceptada de ('172.18.0.11', 60554)'
MAPFS time=2025-02-25 12:30:11,736 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'zZSQgY+mRqoY8sgYYBfx7A==', 'encrypted_metrics': 'Kikk6tsZKj0kXQCs+1QL+LrPhzQ9LD2HlS5gdnnJsOg9gi7IMnWrDl7ez9uFi5hQ'}'
MAPFS time=2025-02-25 12:30:11,737 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 21.92, 'humidity': 53.38}'
MAPFS time=2025-02-25 12:30:11,737 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:30:11,737 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:31:11,796 level=INFO msg='Conexión aceptada de ('172.18.0.11', 58202)'
MAPFS time=2025-02-25 12:31:11,797 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'zezTS+nAMQqYbQ4nvlsPzA==', 'encrypted_metrics': 'EBiSC6RLJiG3lcMvW09atmsHyiBpOGY3DTSEGG3IBWGPK7NcHhpQkPkr3YBLMuer'}'
MAPFS time=2025-02-25 12:31:11,797 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 29.21, 'humidity': 57.44}'
MAPFS time=2025-02-25 12:31:11,798 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:31:11,798 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:32:11,857 level=INFO msg='Conexión aceptada de ('172.18.0.11', 39634)'
MAPFS time=2025-02-25 12:32:11,858 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'FYQychTzis+i2VTthlqDpA==', 'encrypted_metrics': 'pt0IwIZ8APBmIxprbLk1QbAImAf01Td05KK1/RaAWQIE+g2H3NPDFhkUjCcuS5Pu'}'
MAPFS time=2025-02-25 12:32:11,858 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 22.9, 'humidity': 64.95}'
MAPFS time=2025-02-25 12:32:11,859 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:32:11,859 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:33:11,884 level=INFO msg='Conexión aceptada de ('172.18.0.11', 44164)'
MAPFS time=2025-02-25 12:33:11,884 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': '7ao1KdaxSPD+w6/UEa5RZg==', 'encrypted_metrics': 'p+Z63xe2ZPZE/PIB2W78DuJsKuYWM+LugBj4AC2ZT0Zv+M2fV/x0GIfHvjOEmiVo'}'
MAPFS time=2025-02-25 12:33:11,885 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 29.13, 'humidity': 56.57}'
MAPFS time=2025-02-25 12:33:11,885 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:33:11,885 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:34:11,899 level=INFO msg='Conexión aceptada de ('172.18.0.11', 60518)'
MAPFS time=2025-02-25 12:34:11,899 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'KelFxMHxHKBBzWS5yonsTA==', 'encrypted_metrics': 'H9SOmakHVIpMntXubp43BP34zI2gJsbKZoFfPmFuGdx4KY2rOwafmr82aD/abHlF'}'
MAPFS time=2025-02-25 12:34:11,900 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.6, 'humidity': 53.05}'
MAPFS time=2025-02-25 12:34:11,900 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:34:11,900 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:35:11,917 level=INFO msg='Conexión aceptada de ('172.18.0.11', 58796)'
MAPFS time=2025-02-25 12:35:11,918 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'B3GZP1hivXAWG/Nxs6ibsw==', 'encrypted_metrics': '6GCQ30wav/aAnp/ZCJOKlqukrmNdY1xWwyetZNAc7kagtUfVZ91ngNDzVFXGZGZo'}'
MAPFS time=2025-02-25 12:35:11,918 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 27.38, 'humidity': 62.36}'
MAPFS time=2025-02-25 12:35:11,919 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:35:11,919 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:35:46,166 level=INFO msg='Conteo: 1'
MAPFS time=2025-02-25 12:36:11,977 level=INFO msg='Conexión aceptada de ('172.18.0.11', 39916)'
MAPFS time=2025-02-25 12:36:11,978 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'noFyddPjqDuvJdmnQDQ3aw==', 'encrypted_metrics': 'MJY/cs0BO0gabUdFCdtaUOVNc20SlMa/f42/6L+X0SmC/GpV0Ysq4HrPS0Gj/Dje'}'
MAPFS time=2025-02-25 12:36:11,978 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 26.43, 'humidity': 55.6}'
MAPFS time=2025-02-25 12:36:11,979 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:36:11,979 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:37:12,039 level=INFO msg='Conexión aceptada de ('172.18.0.11', 45818)'
MAPFS time=2025-02-25 12:37:12,040 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': '/Yo+c4FkZjo9Z1JeFKswpw==', 'encrypted_metrics': 'nrHh/btECWu55pbqnBW9kV9Q3mZLnlIHIMLyWzZSGigsvZd+WOavfqW5hIkBZpOo'}'
MAPFS time=2025-02-25 12:37:12,040 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 27.43, 'humidity': 60.51}'
MAPFS time=2025-02-25 12:37:12,040 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:37:12,041 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:38:12,053 level=INFO msg='Conexión aceptada de ('172.18.0.11', 49642)'
MAPFS time=2025-02-25 12:38:12,053 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': '9PATkOZtwFT9xSjBBDmcZw==', 'encrypted_metrics': '1rcDPz8tOTDmEZa6vsL4+WZmjtgXGRDaBxNkRJzdD1Y4RGzRj8K7cst12N27Yzs+'}'
MAPFS time=2025-02-25 12:38:12,054 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 29.66, 'humidity': 67.35}'
MAPFS time=2025-02-25 12:38:12,054 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:38:12,054 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:39:12,111 level=INFO msg='Conexión aceptada de ('172.18.0.11', 50316)'
MAPFS time=2025-02-25 12:39:12,111 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'M6lp5sO7e4IR15osXyEBQA==', 'encrypted_metrics': 'hjwgdyAm4kcGp7p6w344yKQUandxC6GAhpgApZixxEb87egUhSBmXBKRhN8hn+5v'}'
MAPFS time=2025-02-25 12:39:12,112 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 27.94, 'humidity': 68.19}'
MAPFS time=2025-02-25 12:39:12,112 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:39:12,112 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:40:12,123 level=INFO msg='Conexión aceptada de ('172.18.0.11', 34610)'
MAPFS time=2025-02-25 12:40:12,123 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'HzvEDeLvUFHAMNYqO6gP3A==', 'encrypted_metrics': 'eJmAGmRpAnXWB5HxjvBOWmF5+1D214mbLh9o6cQeYyXQkiXayMV/4uw2k8YwF6Cw'}'
MAPFS time=2025-02-25 12:40:12,123 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.3, 'humidity': 61.07}'
MAPFS time=2025-02-25 12:40:12,124 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:40:12,124 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:41:12,165 level=INFO msg='Conexión aceptada de ('172.18.0.11', 37090)'
MAPFS time=2025-02-25 12:41:12,166 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'mvwcEvnEioC/Kgn2dBnxcg==', 'encrypted_metrics': 'f8mA0JE+b7wKNvOFaXpuwsb9DIL36uao0T3R4LQlPOh3xm9QvGFEtVh4VRcDnKxg'}'
MAPFS time=2025-02-25 12:41:12,166 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 21.62, 'humidity': 65.08}'
MAPFS time=2025-02-25 12:41:12,166 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:41:12,167 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:42:12,171 level=INFO msg='Conexión aceptada de ('172.18.0.11', 34650)'
MAPFS time=2025-02-25 12:42:12,172 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'V4tdExJBZwEa3SzHbNuClg==', 'encrypted_metrics': 'sUFtJliucCICEPXffJuahgX9alGxQjcbqT9xZ6GLZd3TBy4x04/hPO/dYntsCs85'}'
MAPFS time=2025-02-25 12:42:12,172 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 20.66, 'humidity': 53.27}'
MAPFS time=2025-02-25 12:42:12,172 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:42:12,173 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:42:26,155 level=INFO msg='Conteo: 1'
MAPFS time=2025-02-25 12:43:12,233 level=INFO msg='Conexión aceptada de ('172.18.0.11', 35812)'
MAPFS time=2025-02-25 12:43:12,233 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'XIhKYFYmbNMYyhxyGL4Wig==', 'encrypted_metrics': 'NQBWRkd8DqGjPFuAs1LaHCgKKjZBdS6OzXiUeWOciZLBEdNl7CaHnlpkXwHAozbg'}'
MAPFS time=2025-02-25 12:43:12,234 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 24.45, 'humidity': 61.85}'
MAPFS time=2025-02-25 12:43:12,234 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:43:12,234 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:44:12,270 level=INFO msg='Conexión aceptada de ('172.18.0.11', 49798)'
MAPFS time=2025-02-25 12:44:12,271 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': '1B8/3I5vEIZChKQDVNphsg==', 'encrypted_metrics': '9tsmNGay2QJ8DheIz4bNGzdF/hvfhqb7lNyup683FAmdMOaF27gdvxYHPG0Qxv7P'}'
MAPFS time=2025-02-25 12:44:12,271 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 28.04, 'humidity': 68.45}'
MAPFS time=2025-02-25 12:44:12,272 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:44:12,272 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:45:12,332 level=INFO msg='Conexión aceptada de ('172.18.0.11', 38510)'
MAPFS time=2025-02-25 12:45:12,332 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'fD7GcW2Prrv9E+n+Ybbc1w==', 'encrypted_metrics': 'LqAX/T5XMcf8avYXQKtXZYXtZRN99FSAE2bXFMppKEtEkZ1CR/NJcTcGvgAhrfOb'}'
MAPFS time=2025-02-25 12:45:12,333 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 20.62, 'humidity': 53.07}'
MAPFS time=2025-02-25 12:45:12,333 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:45:12,333 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:46:12,393 level=INFO msg='Conexión aceptada de ('172.18.0.11', 47606)'
MAPFS time=2025-02-25 12:46:12,393 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'eVtVEdL1X+kLVKEfetOlhQ==', 'encrypted_metrics': '4qx0VAkYGE/uf+ONfUx5uizJosJy3slVuszmkyqfcExeJeYnCEf57ryiypCM/q/+'}'
MAPFS time=2025-02-25 12:46:12,394 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 21.35, 'humidity': 61.98}'
MAPFS time=2025-02-25 12:46:12,394 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:46:12,394 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:47:12,454 level=INFO msg='Conexión aceptada de ('172.18.0.11', 55574)'
MAPFS time=2025-02-25 12:47:12,455 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'WnnCrAMoEvF1Apsla9aTow==', 'encrypted_metrics': '+uXRCQgO6NdoM2gHS/48ZABriOllrNtTkLtg4PDDeUTl/WEGoj37X4LRSywImZVw'}'
MAPFS time=2025-02-25 12:47:12,455 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 23.58, 'humidity': 54.32}'
MAPFS time=2025-02-25 12:47:12,455 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:47:12,456 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:48:12,515 level=INFO msg='Conexión aceptada de ('172.18.0.11', 46402)'
MAPFS time=2025-02-25 12:48:12,516 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': '6FdjwsEAfXO7DX+aAmxcTw==', 'encrypted_metrics': 'ZptBerEoXq+QAE0Lxu6y3K0FPAwfuMEp6PMQLC0aUvou13apt4n/RkpTlh+n+VRn'}'
MAPFS time=2025-02-25 12:48:12,516 level=INFO msg='[METRICS] Métricas recibidas descifradas: {'temperature': 25.97, 'humidity': 68.72}'
MAPFS time=2025-02-25 12:48:12,516 level=INFO msg='[METRICS] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-02-25 12:48:12,517 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:49:06,248 level=INFO msg='Conteo: 1'
MAPFS time=2025-02-25 12:49:06,249 level=WARNING msg='[REVOC] Actividad sospechosa detectada para 96991248252922197919740685908646567083801574626180075667347743251664730525151. Solicitando revocación.'
MAPFS time=2025-02-25 12:49:06,249 level=INFO msg='[REVOC] Enviando solicitud de revocación a mapfs-cloud:5001.'
MAPFS time=2025-02-25 12:49:06,254 level=INFO msg='[REVOC] Mensaje recibido: {'operation': 'identify_and_revoke', 'ID_a': 4817013578809384280, 'X_a_pub_key': {'x': 108258027930428254374648737500092581555238822129749451785535904747447721011384, 'y': 84764202574202673850736366554675194551348036385165788540773828922643800698107}, 'Y_a_pub_key': {'x': 18832015717852246093658270804604531706445729900186004056305197414001397490803, 'y': 80653102006237323686250111457364126309539819202246249059165983458851068239886}, 'h_a': 98558204309991489772323230878962324658255319672350130227524097179890628554832, 'P_1': {'x': 38973247595115323391539420141203016041983052640013053785809118164357967360166, 'y': 22415777058475630235477818425939466002197917846170014091928281807800444209703}, 'P_3': {'x': 104148123326937756825879658388975862488958435166627359411753679508978350756083, 'y': 1347861896312009524821178100052610366616978608099304505856189797222035214012}}'
MAPFS time=2025-02-25 12:49:06,254 level=INFO msg='[REVOC] revocation_id = 87387448891429473352911250393751022985853477366099438644989445065336095242265'
MAPFS time=2025-02-25 12:49:06,255 level=INFO msg='unique_identifier = 96991248252922197919740685908646567083801574626180075667347743251664730525151'
MAPFS time=2025-02-25 12:49:06,255 level=INFO msg='[REVOC] Dispositivo revocado y bloqueado.'
MAPFS time=2025-02-25 12:49:12,577 level=INFO msg='Conexión aceptada de ('172.18.0.11', 52916)'
MAPFS time=2025-02-25 12:49:12,577 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'FvPNtulFL9gElvfTXwm7Mg==', 'encrypted_metrics': '9dalg1KlraJw6eMZ0sW0NEX+CgYyqIb00is6y01A/Y3wox1rjl6CHWaWeWZICIrr'}'
MAPFS time=2025-02-25 12:49:12,578 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 96991248252922197919740685908646567083801574626180075667347743251664730525151 no autenticado.'
MAPFS time=2025-02-25 12:49:12,578 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:50:12,601 level=INFO msg='Conexión aceptada de ('172.18.0.11', 48848)'
MAPFS time=2025-02-25 12:50:12,602 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': '7171yqT0vY7oi84ZBxE2HQ==', 'encrypted_metrics': 'jjMSw4fwkBTHp25t+OfUsRvWbTJ+i3nYM/TJPJmeB/PL4Br6NKpqiqcemr6mjkYQ'}'
MAPFS time=2025-02-25 12:50:12,602 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 96991248252922197919740685908646567083801574626180075667347743251664730525151 no autenticado.'
MAPFS time=2025-02-25 12:50:12,602 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:51:12,662 level=INFO msg='Conexión aceptada de ('172.18.0.11', 47252)'
MAPFS time=2025-02-25 12:51:12,663 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'vvbN1WbSRXnF5MUf51B25A==', 'encrypted_metrics': 'K0qkvklkqzAJuDu8EyIYo3GMm88vo1n1/ygTlGRMw6zz17qz0DDNcO2LcGVjVMQf'}'
MAPFS time=2025-02-25 12:51:12,663 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 96991248252922197919740685908646567083801574626180075667347743251664730525151 no autenticado.'
MAPFS time=2025-02-25 12:51:12,663 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-02-25 12:52:12,723 level=INFO msg='Conexión aceptada de ('172.18.0.11', 40334)'
MAPFS time=2025-02-25 12:52:12,724 level=INFO msg='Mensaje recibido: {'operation': 'send_metrics', 'A': {'x': 68680274172549401547534177808867129064268633035492157928453867677656826663302, 'y': 62702700176462769280685129183578922630982454961370360707488345437849062186626}, 'W': {'x': 54821680924423679402377321111059506778766400598537449826815440571142298271863, 'y': 103648478385252965441593392498009715085866136984227381661943270812913648200512}, 'iv': 'by3MbimEyuARpaF4a4LfuA==', 'encrypted_metrics': '6OngKtjGsefJWhWl0VPWbbDYBHWOq1DTo7zUPj0M/K6aG8ZPaPXdV8bHNlh/2+hZ'}'
MAPFS time=2025-02-25 12:52:12,724 level=ERROR msg='[METRICS] Error en el mensaje recibido: Dispositivo con ID: 96991248252922197919740685908646567083801574626180075667347743251664730525151 no autenticado.'
MAPFS time=2025-02-25 12:52:12,725 level=INFO msg='Conexión con el cliente cerrada.'
