MAPFS time=2025-04-20 15:37:54,280 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8011.'
MAPFS time=2025-04-20 15:37:54,310 level=INFO msg='Servidor Cloud escuchando en 0.0.0.0:5001'
MAPFS time=2025-04-20 15:37:59,720 level=INFO msg='Conexión aceptada de ('172.18.0.9', 32930)'
MAPFS time=2025-04-20 15:37:59,725 level=INFO msg='Mensaje recibido: {'operation': 'register_gateway'}'
MAPFS time=2025-04-20 15:37:59,727 level=INFO msg='[REG Gateway] Enviar parámetros públicos: {'Pub_gc_key': {'x': 21177946515075061687550791694630544457495970075002376965874600479642368933534, 'y': 92236785872001380457189012603395899274187319854444042842081342129414266413390}, 'P_IoT_key': {'x': 11793167108374714450081443668939525841347829016346511493581507395368730469025, 'y': 22411024432054074270843369479455891801200931331140479066062892424924858034562}, 'operation': 'register'}'
MAPFS time=2025-04-20 15:37:59,736 level=INFO msg='[REG Gateway] Recibidos datos del gateway: Gateway_Identity=3445939985476440605, X_w_pub_key={'x': 45430545540069393172942792458423082409066439757237537565595191725645429671265, 'y': 114909364873093874814031642025679172288290918422996675110069379569963988914624}'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='[REG Gateway] Gateway con ID 3445939985476440605 registrado exitosamente. Claves asociadas: {'IP': '172.18.0.9', 'X_w_pub_key': {'x': 45430545540069393172942792458423082409066439757237537565595191725645429671265, 'y': 114909364873093874814031642025679172288290918422996675110069379569963988914624}, 'Y_w_pub_key': {'x': 3029868824243643875722711890918973288729147127789719230203469428232660372707, 'y': 56749431097275587367271285635028116033939373862123034215890038219149915741680}, 'y_w_priv_key': 23598799956736218436429344494857199032275450950028964406358985828632855758426, 'h_w': 88855974626270462232489351607866537318924391469000447946065551481564725487451}'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='[REG Gateway] Respuesta enviada al gateway.'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='[REG Gateway] Conexión con el Gateway cerrada.'
MAPFS time=2025-04-20 15:37:59,740 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:38:05,245 level=INFO msg='Conexión aceptada de ('172.18.0.10', 52786)'
MAPFS time=2025-04-20 15:38:05,248 level=INFO msg='Mensaje recibido: {'operation': 'register_device'}'
MAPFS time=2025-04-20 15:38:05,249 level=INFO msg='[REG Dispositivo] Enviar parámetros públicos: {'Pub_gc_key': {'x': 21177946515075061687550791694630544457495970075002376965874600479642368933534, 'y': 92236785872001380457189012603395899274187319854444042842081342129414266413390}, 'P_IoT_key': {'x': 11793167108374714450081443668939525841347829016346511493581507395368730469025, 'y': 22411024432054074270843369479455891801200931331140479066062892424924858034562}, 'operation': 'register'}'
MAPFS time=2025-04-20 15:38:05,259 level=INFO msg='[REG Dispositivo] Recibidos datos del dispositivo IoT: IoT_Identity=12690263487218622427, X_a_pub_key={'x': 4012385738547435301142039489199932682211343568487251552973528691858139015094, 'y': 84726835359740451950929447891920657063279224681046027640857329293432813694342}, h_x={'x': 4597832850250714819174401565828028026511559974200541778863284398515122962884, 'y': 105664474150913922576489664586532574527132288989349522430658517092260406060316}'
MAPFS time=2025-04-20 15:38:05,260 level=INFO msg='[REG Dispositivo] Dispositivo IoT con ID 12690263487218622427 registrado exitosamente. Claves asociadas: {'IP': '172.18.0.10', 'X_a_pub_key': {'x': 4012385738547435301142039489199932682211343568487251552973528691858139015094, 'y': 84726835359740451950929447891920657063279224681046027640857329293432813694342}, 'Y_a_pub_key': {'x': 83704805075390084828880892119956347538020387902824187657320850778920410051239, 'y': 112287209389999757352027095666199169469281051028413447113166459860137049025351}, 'y_a_priv_key': 21598994397957575041424411169353047849623990724831644067534997444948071402622, 'h_a': 27550289557081766113616009622046570385274335276087354250852223971515873831813, 'h_x': {'x': 4597832850250714819174401565828028026511559974200541778863284398515122962884, 'y': 105664474150913922576489664586532574527132288989349522430658517092260406060316}}'
MAPFS time=2025-04-20 15:38:05,261 level=INFO msg='[REG Dispositivo] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-04-20 15:38:05,261 level=INFO msg='[REG Dispositivo] Conexión con el dispositivo IoT cerrada.'
MAPFS time=2025-04-20 15:38:05,262 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:41:38,587 level=INFO msg='Conexión aceptada de ('172.18.0.4', 50460)'
MAPFS time=2025-04-20 15:41:38,588 level=INFO msg='Mensaje recibido: {'operation': 'identify_and_revoke', 'P_1': {'x': 95511148566065364250942207858655193192425991347096017143134118521577008182548, 'y': 99738441963798228302116853883118045234903444266142981682664839257102420392606}, 'P_3': {'x': 2379776427754342215847616503272387354119552286279675908882668469333857606805, 'y': 53452390842102568830880033844100139093331372161346302970565721582733187540859}}'
MAPFS time=2025-04-20 15:41:38,590 level=INFO msg='[REVOC] Dispositivo identificado para revocación: 12690263487218622427'
MAPFS time=2025-04-20 15:41:38,591 level=INFO msg='[REVOC] Conectando a Gateway en 172.18.0.9:6000.'
MAPFS time=2025-04-20 15:41:38,597 level=INFO msg='[REVOC] Respuesta de 172.18.0.9: '
MAPFS time=2025-04-20 15:41:38,597 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 15:41:42,010 level=INFO msg='Conexión aceptada de ('172.18.0.4', 55474)'
MAPFS time=2025-04-20 15:41:42,010 level=INFO msg='Mensaje recibido: {'operation': 'identify_and_revoke', 'P_1': {'x': 41664292896829198667345530341035175819856187570081900634936449979720274459674, 'y': 720177954054826808075888520914101989130456228612955833611342000904878965612}, 'P_3': {'x': 41664292896829198667345530341035175819856187570081900634936449979720274459674, 'y': 720177954054826808075888520914101989130456228612955833611342000904878965612}}'
MAPFS time=2025-04-20 15:41:42,012 level=WARNING msg='[REVOC] No se encontró un dispositivo que cumpla con la condición P_3 = h_a * P_1.'
MAPFS time=2025-04-20 15:41:42,012 level=ERROR msg='[REVOC] Error en el mensaje recibido: Los P_1 o P_3 son incorrectos.'
MAPFS time=2025-04-20 15:41:42,013 level=INFO msg='Conexión con el cliente cerrada.'
