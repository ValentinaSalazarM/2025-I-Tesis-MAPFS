MAPFS time=2025-04-20 14:49:08,171 level=INFO msg='Iniciando el servidor de métricas de Prometheus en el puerto 8011.'
MAPFS time=2025-04-20 14:49:08,201 level=INFO msg='Servidor Cloud escuchando en 0.0.0.0:5001'
MAPFS time=2025-04-20 14:49:13,873 level=INFO msg='Conexión aceptada de ('172.18.0.9', 40214)'
MAPFS time=2025-04-20 14:49:13,880 level=INFO msg='Mensaje recibido: {'operation': 'register_gateway'}'
MAPFS time=2025-04-20 14:49:13,882 level=INFO msg='[REG Gateway] Enviar parámetros públicos: {'Pub_gc_key': {'x': 76415355751547062808216326622888136501253568475777662022009531328498054668255, 'y': 27551191082709565210439656718996253846675723643096576424350033982264074260899}, 'P_IoT_key': {'x': 5921642071607172762889065028380023938127011410638719176250835248222350118176, 'y': 2886709529126598620725787034878643261944157115072347388701684369620696039076}, 'operation': 'register'}'
MAPFS time=2025-04-20 14:49:13,891 level=INFO msg='[REG Gateway] Recibidos datos del gateway: Gateway_Identity=16941425626696043432, X_w_pub_key={'x': 113902536421875312725190451776238789621540789730166989557098423322522114284272, 'y': 71555245326783575092233457517444871466177911549351957170614807934352407648509}'
MAPFS time=2025-04-20 14:49:13,897 level=INFO msg='[REG Gateway] Gateway con ID 16941425626696043432 registrado exitosamente. Claves asociadas: {'IP': '172.18.0.9', 'X_w_pub_key': {'x': 113902536421875312725190451776238789621540789730166989557098423322522114284272, 'y': 71555245326783575092233457517444871466177911549351957170614807934352407648509}, 'Y_w_pub_key': {'x': 93419364618373708416323865371904969937037610011843409803555600271337296313155, 'y': 73068838723398383403047820426695466859769101229249294800633561399146975586319}, 'y_w_priv_key': 29378462824944325122650972911839268606644191889435378122441598816336583299779, 'h_w': 66822158172192236042079334264024841702646552482324280183941929188775189792311}'
MAPFS time=2025-04-20 14:49:13,898 level=INFO msg='[REG Gateway] Respuesta enviada al gateway.'
MAPFS time=2025-04-20 14:49:13,898 level=INFO msg='[REG Gateway] Conexión con el Gateway cerrada.'
MAPFS time=2025-04-20 14:49:13,898 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 14:49:19,326 level=INFO msg='Conexión aceptada de ('172.18.0.10', 33626)'
MAPFS time=2025-04-20 14:49:19,330 level=INFO msg='Mensaje recibido: {'operation': 'register_device'}'
MAPFS time=2025-04-20 14:49:19,330 level=INFO msg='[REG Dispositivo] Enviar parámetros públicos: {'Pub_gc_key': {'x': 76415355751547062808216326622888136501253568475777662022009531328498054668255, 'y': 27551191082709565210439656718996253846675723643096576424350033982264074260899}, 'P_IoT_key': {'x': 5921642071607172762889065028380023938127011410638719176250835248222350118176, 'y': 2886709529126598620725787034878643261944157115072347388701684369620696039076}, 'operation': 'register'}'
MAPFS time=2025-04-20 14:49:19,339 level=INFO msg='[REG Dispositivo] Recibidos datos del dispositivo IoT: IoT_Identity=16803350910982573170, X_a_pub_key={'x': 59406965835633894408815898727464868807638918548337026351680340075829038915967, 'y': 33777422844512578656187463392831586171897359669500059792823244872192081512681}, h_x={'x': 76023406192405914129336384461186414616203405294313359784633948693102331003601, 'y': 62902524448331816826912364081958032004935840566200386552573549177814338463890}'
MAPFS time=2025-04-20 14:49:19,340 level=INFO msg='[REG Dispositivo] Dispositivo IoT con ID 16803350910982573170 registrado exitosamente. Claves asociadas: {'IP': '172.18.0.10', 'X_a_pub_key': {'x': 59406965835633894408815898727464868807638918548337026351680340075829038915967, 'y': 33777422844512578656187463392831586171897359669500059792823244872192081512681}, 'Y_a_pub_key': {'x': 108368921139591558371711621961755351260553993176631819478435169502030258192071, 'y': 76410871364995082012743935883553700157631822371006373045553426419676224324592}, 'y_a_priv_key': 21959212398593830831466216722474717369565374403929570492455195166361733146432, 'h_a': 58004050928023711842906195513843548461754408329401368594674373055625856168672, 'h_x': {'x': 76023406192405914129336384461186414616203405294313359784633948693102331003601, 'y': 62902524448331816826912364081958032004935840566200386552573549177814338463890}}'
MAPFS time=2025-04-20 14:49:19,340 level=INFO msg='[REG Dispositivo] Respuesta enviada al dispositivo IoT.'
MAPFS time=2025-04-20 14:49:19,341 level=INFO msg='[REG Dispositivo] Conexión con el dispositivo IoT cerrada.'
MAPFS time=2025-04-20 14:49:19,341 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 14:56:59,574 level=INFO msg='Conexión aceptada de ('172.18.0.4', 54676)'
MAPFS time=2025-04-20 14:56:59,574 level=INFO msg='Mensaje recibido: {'operation': 'identify_and_revoke', 'P_1': {'x': 14462412544176216971364099191008657098079090959132655557268243669939246637478, 'y': 87596589567890144156725689487791905567836745196105376220449093837231763628057}, 'P_3': {'x': 78972744248660163857981368811282748291700450334756722595712676151396291611170, 'y': 23679323212058800888079327570789375892817864341789817213482925160531471484323}}'
MAPFS time=2025-04-20 14:56:59,576 level=INFO msg='[REVOC] Dispositivo identificado para revocación: 16803350910982573170'
MAPFS time=2025-04-20 14:56:59,577 level=INFO msg='[REVOC] Conectando a Gateway en 172.18.0.9:6000.'
MAPFS time=2025-04-20 14:56:59,578 level=INFO msg='[REVOC] Respuesta de 172.18.0.9: '
MAPFS time=2025-04-20 14:56:59,579 level=INFO msg='Conexión con el cliente cerrada.'
MAPFS time=2025-04-20 14:58:36,550 level=INFO msg='Conexión aceptada de ('172.18.0.4', 60596)'
MAPFS time=2025-04-20 14:58:36,550 level=INFO msg='Mensaje recibido: {'operation': 'identify_and_revoke', 'P_1': {'x': 32186772299553599616737862179601242470980303975057441412061180267715384846669, 'y': 75343803876091452012450645323621789987096464847995758565619635432105292086107}, 'P_3': {'x': 32186772299553599616737862179601242470980303975057441412061180267715384846669, 'y': 75343803876091452012450645323621789987096464847995758565619635432105292086107}}'
MAPFS time=2025-04-20 14:58:36,552 level=WARNING msg='[REVOC] No se encontró un dispositivo que cumpla con la condición P_3 = h_a * P_1.'
MAPFS time=2025-04-20 14:58:36,552 level=ERROR msg='[REVOC] Error en el mensaje recibido: Los P_1 o P_3 son incorrectos.'
MAPFS time=2025-04-20 14:58:36,553 level=INFO msg='Conexión con el cliente cerrada.'
